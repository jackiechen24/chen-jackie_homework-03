---
title: "Homework 3"
date: 2024-06-02
author: "Jackie Chen"
format: docx
---

[Forked repository](https://github.com/jackiechen24/chen-jackie_homework-03)

# Set Up

## Reading in packages/data
```{r}
# general use
library(tidyverse)
library(readxl)
library(here)
library(janitor)

# visualizing pairs
library(GGally)

# model selection
library(MuMIn)

# model predictions
library(ggeffects)

# model tables
library(gtsummary)
library(flextable)
library(modelsummary)

drought_exp <- read_xlsx(path = here("data", 
                                     "Valliere_etal_EcoApps_Data.xlsx"),
                         sheet = "First Harvest")
```

# Problem 1. Multiple linear regression: model selection and construction (52 points)

## a. Make a table or list of all the models from class and the last one you constructed on your own. Write a caption for your table. (8 points)
Caption: table captions typically go above the table. Number the table and provide a title. Describe what is in the table (columns and rows).

Table: In your table, each row should be a model with the model number (1, 2, 3, etc.) and the predictors for each model

Table of Models

Table 1. Table of Models. Columns are the model number and model predictors, and rows contain information on the model number and predictors for each model.
![Table of Models](table1.png)

## b. Write a 5-6 sentence “statistical methods” section. (8 points)
Your answer should be in paragraph form and include:

- how you addressed the central question(s) (i.e. to examine the influence of ____, ____, and ____ on _____, I…)

- how you chose the final model (i.e. to determine the model that best described ____, I…)

- how you visually determined that your final model conformed to the assumptions of a linear model (i.e. to evaluate linear model assumptions, I…)

To examine the influence of SLA, water treatment, and species on total biomass, I made a table of all of the possible models (the null model, the saturated model, and the models with combinations of some of the predictors). To determine the model that best described the total biomass, I looked at the AIC of all of the models. The model with the lowest AIC is the best model that describes total mass without sacrificing complexity, and out of the five models we have tried, the best model is the one that includes the predictors of water treatment and species. To evaluate linear model assumptions, I looked at the diagnostics of this model. The diagnostics for this model look good because the standardized residuals might flare out a bit but potentially is not a big deal and so the residuals are homoscedastic, the Q-Q Plot (Q-Q Residuals) shows a mostly straight line aside from a little bit of flare out at the tails and so the residuals are normally distributed, and there does not seem to be any outliers since there does not appear to be anything outside the dotted lines when looking at the Constant Leverage: Residuals vs Factor Levels Plot.

## c. Make a visualization of the model predictions with underlying data for your “best” model. (20 points)
Show and annotate all your code. For full credit:

- make the underlying data more transparent than the model predictions

- display species names in full (not as species codes like ENCCAL or ESCCAL)

- display water treatment types in full (not as WW or DS)

- represent well-watered and drought stressed treatments with different colors

- use colors that are not the default ggplot() colors

- facet your plot by species

- remove the legend

- finalize the plot

## Cleaning
```{r}
# cleaning the data
drought_exp_clean <- drought_exp %>% 
  clean_names() %>% # nicer column names
  # display species names in full by adding column with species scientific names
  mutate(species_name = case_when(
    species == "ENCCAL" ~ "Encelia californica", # bush sunflower
    species == "ESCCAL" ~ "Eschscholzia californica", # California poppy
    species == "PENCEN" ~ "Penstemon centranthifolius", # Scarlet bugler
    species == "GRICAM" ~ "Grindelia camporum", # great valley gumweed
    species == "SALLEU" ~ "Salvia leucophylla", # Purple sage
    species == "STIPUL" ~ "Nasella pulchra", # Purple needlegrass
    species == "LOTSCO" ~ "Acmispon glaber" # deerweed
  )) %>% 
  relocate(species_name, .after = species) %>% # moving species_name column after species
  # display water treatment types in full by adding column with full treatment names
  mutate(water_treatment = case_when(
    water == "WW" ~ "Well watered",
    water == "DS" ~ "Drought stressed"
  )) %>% 
  relocate(water_treatment, .after = water) # moving water_treatment column after water
```

Model predictions
```{r}
model_preds <- ggpredict(model5, 
                         terms = c("water_treatment", 
                                   "species_name"))
```

Visualization of model predictions
```{r}
# creating new data frame of model predictions for plotting
model_preds_for_plotting <- model_preds %>% 
  rename(water_treatment = x, # renaming columns to make this easier to use
         species_name = group)
# visualization of the data
  ggplot() +
  # plot the underlying data
  geom_jitter(data = drought_exp_clean,
             aes(x = water_treatment,
                 y = total_g,
                 color = water_treatment),
             alpha = 0.3,
             width = 0.1, # narrow jitter
              height = 0) + # not jittering points up and down
  # plot the model predictions with error bars
  geom_pointrange(data = model_preds_for_plotting, 
                  aes(x = water_treatment, 
                      y = predicted, 
                      ymin = conf.low, 
                      ymax = conf.high, 
                      color = water_treatment)) +
  # Customizing colors
  scale_color_manual(values = c("Well watered" = "darkgreen", 
                                "Drought stressed" = "brown")) +
  # creating different panels for species
  facet_wrap(~species_name) +
  # Removing legend
  theme(legend.position = "none",
        axis.text.x = element_text(angle = 60, hjust = 1),
        plot.title = element_text(size = 16, face = "bold")) +
  # Adding titles and labels
  labs(title = "Model Predictions Visualization with Underlying Data",
       x = "Water Treatment",
       y = "Total Biomass Predictions")
```

## d. Write a caption for your visualization. (6 points)
Include a data citation.

Data from Dryad (Valliere, 2019).

Figure 1. Total biomass predictions with underlying data are higher in the well watered water treatment than the drought stressed water treatment. The plotted data are the mean and 95% confidence interval of the total biomass predictions (g), as well as the underlying data of the total biomass (g), of the well watered water treatment and drought stressed water treatment for the species Acmispon glaber, Encelia californica, Eschscolzia californica, Grindelia camporum, Nasella pulchra, Penstemon centranthifolius, and Salvia leucophylla (n = 5). The green data points represent the well watered water treatment, while the brown data points represent the drought stressed water treatment.

## e. Write a 3-4 sentence results section. (10 points)
Your answer should be in paragraph form and address the following points:

- what predictors "best" described total mass (include model statistics here)?

- on average, what differences did you find between water treatments?

- on average, what differences did you find between species?

The predictors that "best" described total mass were water treatment and species (Adjusted R^2 = 0.7257, F(7, 62) = 27.08, p-value < 0.001, AIC = -156.2, alpha = 0.05). On average, total mass was higher in the well watered water treatment than the drought stressed water treatment. The Grindelia camporum species on average had the highest total mass out of all the species, while the Acmispon glaber species had the lowest total mass out of all the species.

# Problem 2. Affective visualization (24 points)

## a. Describe in words what an affective visualization could look like for your personal data (3-5 sentences). (2 points)

For my personal data, an affective visualization could look like representing different shapes and colors for the different values of the variables in my data. Specifically, I could use green outlines of shapes like circles, triangles, and squares to represent the "yes" values, while red outlines of shapes could represent the "no" values for the binary variables (such as Cooking/stove, Leftovers, and Air Fryer). Meanwhile, the different foods in the Foods in Meal variable can be represented with different colors (e.g. the color brown representing meals with a sandwich and the color yellow representing meals with string cheese). Moreover, my affective visualization could have stacked bar plots for different meals, with higher stacked bar plots representing higher food type counts, and observations can be ordered by time. Different patterns in my affective visualization could represent different locations of where the food was bought (e.g. horizontal striped pattern representing food bought at grocery stores and N/A values of food that does not have a known location of where it was bought will not have a pattern), different types of food (e.g. American food represented by a zigzag pattern, Chinese food represented by a star pattern), and the location of the meal (e.g. meals eaten at my apartment can be represented by a diagonal left pattern and meals eaten at restaurants can be represented by a diagonal right pattern).

## b. Create a sketch (on paper) of your idea. (2 points)
Include a photo of this sketch in your submission.

![Sketch of Idea](problem2-sketch.jpeg)

## c. Make a draft of your visualization. (12 points)
Feel free to be creative with this! You do not have to do this in R. You could create a sculpture, painting, textile object, etc.

If you are making your visualization in R, show the annotated code and the output.

If you are making your visualization outside of R, include a photo of your visualization in your submission.
![Breakfast Food Bar Plot](breakfastplot.png)

## d. Write an artist statement. (8 points)
An artist statement gives the audience context to understand your work. Write 4-5 sentences to address:

- the content of your piece (what are you showing?)

- the influences (what did techniques/artists/etc. did you find influential in creating your work?)

- the form of your work (written code, watercolor, oil painting, etc.)

- your process (how did you create your work?)

The plot shows the food bar plot for different meals that I have eaten during breakfast from April 22, 2024 to May 28, 2024. I was influenced by Stefanie Posavec and Giorgia Lupi’s Dear Data project. My work is in the form of an online design from Canva, which was what I used to create my work. I used the presentation format in Canva and created my work by adding text, shapes, shape outlines, drawings (including those of various patterns), and images to create the bar plots and legend to show what the shapes, shape outlines, patterns represent.

# Problem 3. Statistical critique (36 points)
At this point, you have seen and created a lot of figures for this class. Revisit the paper you chose for your critique and your homework 2, where you described figures or tables in the text. Address the following in full sentences (3-4 sentences each).

For this section of your homework, you will be evaluated on the logic, conciseness, and nuance of your critique.

## a. Revisit and summarize (6 points)
What are the statistical tests the authors are using to address their main research question?

Insert the figure or table you described in Homework 2 here.

## b. Visual clarity (10 points)
How clearly did the authors visually represent their statistics in figures? For example, are the x- and y-axes in a logical position? Do they show summary statistics (means and SE, for example) and/or model predictions, and if so, do they show the underlying data?

## c. Aesthetic clarity (10 points)
How well did the authors handle “visual clutter”? How would you describe the the data:ink ratio?

## d. Recommendations (can be longer than 4 sentences, 10 points)
What recommendations would you make to make the figure better? What would you take out, add, or change? Provide explanations/justifications for each of your recommendations.

Alternatively, if they did not represent their statistics in a figure, what kind of figure would you recommend to them? Describe the x- and y-axes, with any geometries and aesthetics (colors, etc.). Provide enough explanation such that someone would be able to create the figure you describe in code. Provide explanations/justifications for the figure you would recommend.